<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MadLab Finance · v2 (offline)</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<header>
  <h1>MadLab Finance <span>· v2 (offline)</span></h1>
  <nav>
    <button class="tab-btn active" data-tab="dashboard">Dashboard</button>
    <button class="tab-btn" data-tab="config">Config</button>
    <button class="tab-btn" data-tab="mensal">Mensal</button>
    <button class="tab-btn" data-tab="inss">INSS</button>
    <button class="tab-btn" data-tab="lucros">Controle de Lucros</button>
    <button class="tab-btn" data-tab="resumo">Resumo</button>
    <button class="tab-btn" data-tab="instrucoes">Instruções</button>
  </nav>
  <div class="actions">
    <button id="btnSave">Salvar (JSON)</button>
    <input type="file" id="fileLoad" accept="application/json" hidden>
    <button id="btnLoad">Carregar</button>
    <button id="btnReset">Zerar</button>
  </div>
</header>

<main>
<section id="dashboard" class="tab active">
  <div class="kpis">
    <div class="kpi"><div class="kpi-label">Margem Líquida</div><div class="kpi-value" id="kpiMargem">--</div></div>
    <div class="kpi"><div class="kpi-label">Carga Tributária</div><div class="kpi-value" id="kpiCarga">--</div></div>
    <div class="kpi"><div class="kpi-label">Reserva Garantida</div><div class="kpi-value" id="kpiReserva">--</div></div>
    <div class="kpi"><div class="kpi-label">Lucro Distribuído</div><div class="kpi-value" id="kpiDistribuido">--</div></div>
    <div class="kpi"><div class="kpi-label">Lucro Retido</div><div class="kpi-value" id="kpiRetido">--</div></div>
  </div>
  <div class="cards">
    <div class="card">
      <h3>Bruto × Líquido × Impostos (Mensal)</h3>
      <canvas id="chartLinha" width="900" height="300"></canvas>
    </div>
    <div class="card">
      <h3>Distribuição de Lucros (Mensal)</h3>
      <canvas id="chartBar" width="900" height="300"></canvas>
    </div>
  </div>
  <div class="decision" id="painelDecisao">Este mês → Distribuir (CPF): -- | Guardar (reserva): --</div>
</section>

<section id="config" class="tab">
  <h2>Configuração</h2>
  <div class="grid">
    <label>DAS Efetivo (Anexo V) %
      <input type="number" id="cfgDas" step="0.001" min="0" max="1" />
      <small>Ex.: 0.103 = 10,3%</small>
    </label>
    <label>INSS teto mensal (R$)
      <input type="number" id="cfgInssTeto" step="1" min="0" />
    </label>
    <label>Plano de Saúde (R$/mês)
      <input type="number" id="cfgSaude" step="1" min="0" />
    </label>
    <label>Contador (R$/mês)
      <input type="number" id="cfgContador" step="1" min="0" />
    </label>
    <label>Pró-labore fixo (R$)
      <input type="number" id="cfgProlabore" step="1" min="0" />
    </label>
    <label>Reserva de Caixa (meses)
      <input type="number" id="cfgReservaMeses" step="1" min="0" />
    </label>
  </div>
  <button class="primary" id="btnAplicarCfg">Aplicar</button>

  <h3>Meses de Incidência (Despesas e INSS)</h3>
  <div class="monthly-matrix">
    <div class="row header"><div>Categoria</div><div>Jan</div><div>Fev</div><div>Mar</div><div>Abr</div><div>Mai</div><div>Jun</div><div>Jul</div><div>Ago</div><div>Set</div><div>Out</div><div>Nov</div><div>Dez</div></div>
    <div class="row"><div>Plano de Saúde</div>
      <div><input type="checkbox" class="mx saude" data-idx="0"></div>
      <div><input type="checkbox" class="mx saude" data-idx="1"></div>
      <div><input type="checkbox" class="mx saude" data-idx="2"></div>
      <div><input type="checkbox" class="mx saude" data-idx="3"></div>
      <div><input type="checkbox" class="mx saude" data-idx="4"></div>
      <div><input type="checkbox" class="mx saude" data-idx="5"></div>
      <div><input type="checkbox" class="mx saude" data-idx="6"></div>
      <div><input type="checkbox" class="mx saude" data-idx="7"></div>
      <div><input type="checkbox" class="mx saude" data-idx="8"></div>
      <div><input type="checkbox" class="mx saude" data-idx="9"></div>
      <div><input type="checkbox" class="mx saude" data-idx="10"></div>
      <div><input type="checkbox" class="mx saude" data-idx="11"></div>
    </div>
    <div class="row"><div>Contador</div>
      <div><input type="checkbox" class="mx contador" data-idx="0"></div>
      <div><input type="checkbox" class="mx contador" data-idx="1"></div>
      <div><input type="checkbox" class="mx contador" data-idx="2"></div>
      <div><input type="checkbox" class="mx contador" data-idx="3"></div>
      <div><input type="checkbox" class="mx contador" data-idx="4"></div>
      <div><input type="checkbox" class="mx contador" data-idx="5"></div>
      <div><input type="checkbox" class="mx contador" data-idx="6"></div>
      <div><input type="checkbox" class="mx contador" data-idx="7"></div>
      <div><input type="checkbox" class="mx contador" data-idx="8"></div>
      <div><input type="checkbox" class="mx contador" data-idx="9"></div>
      <div><input type="checkbox" class="mx contador" data-idx="10"></div>
      <div><input type="checkbox" class="mx contador" data-idx="11"></div>
    </div>
    <div class="row"><div>INSS Folha (11%)</div>
      <div><input type="checkbox" class="mx inssfolha" data-idx="0"></div>
      <div><input type="checkbox" class="mx inssfolha" data-idx="1"></div>
      <div><input type="checkbox" class="mx inssfolha" data-idx="2"></div>
      <div><input type="checkbox" class="mx inssfolha" data-idx="3"></div>
      <div><input type="checkbox" class="mx inssfolha" data-idx="4"></div>
      <div><input type="checkbox" class="mx inssfolha" data-idx="5"></div>
      <div><input type="checkbox" class="mx inssfolha" data-idx="6"></div>
      <div><input type="checkbox" class="mx inssfolha" data-idx="7"></div>
      <div><input type="checkbox" class="mx inssfolha" data-idx="8"></div>
      <div><input type="checkbox" class="mx inssfolha" data-idx="9"></div>
      <div><input type="checkbox" class="mx inssfolha" data-idx="10"></div>
      <div><input type="checkbox" class="mx inssfolha" data-idx="11"></div>
    </div>
    <div class="row"><div>INSS Complementar</div>
      <div><input type="checkbox" class="mx insscomp" data-idx="0"></div>
      <div><input type="checkbox" class="mx insscomp" data-idx="1"></div>
      <div><input type="checkbox" class="mx insscomp" data-idx="2"></div>
      <div><input type="checkbox" class="mx insscomp" data-idx="3"></div>
      <div><input type="checkbox" class="mx insscomp" data-idx="4"></div>
      <div><input type="checkbox" class="mx insscomp" data-idx="5"></div>
      <div><input type="checkbox" class="mx insscomp" data-idx="6"></div>
      <div><input type="checkbox" class="mx insscomp" data-idx="7"></div>
      <div><input type="checkbox" class="mx insscomp" data-idx="8"></div>
      <div><input type="checkbox" class="mx insscomp" data-idx="9"></div>
      <div><input type="checkbox" class="mx insscomp" data-idx="10"></div>
      <div><input type="checkbox" class="mx insscomp" data-idx="11"></div>
    </div>
  </div>

  <h3>Propagação Automática de Caixa</h3>
  <div class="auto-flow">
    <label><input type="checkbox" id="cfgAutoCaixa"> Ativar modo automático (Saldo Final - Recomendado → Saldo Inicial do próximo mês)</label>
    <button id="btnPropagar">Propagar até Dezembro</button>
  </div>
</section>

<section id="mensal" class="tab">
  <h2>Lançamentos Mensais</h2>
  <div id="months" class="months"></div>
</section>

<section id="inss" class="tab">
  <h2>INSS (Folha + Complementar)</h2>
  <table id="tblInss">
    <thead><tr><th>Mês</th><th>INSS Folha (11%)</th><th>Complementar</th><th>Total</th></tr></thead>
    <tbody></tbody>
    <tfoot><tr><th>Total</th><th id="sumInssFolha">--</th><th id="sumInssComp">--</th><th id="sumInssTotal">--</th></tr></tfoot>
  </table>
</section>

<section id="lucros" class="tab">
  <h2>Controle de Lucros (Reserva inteligente)</h2>
  <table id="tblLucros">
    <thead><tr><th>Mês</th><th>Saldo Final</th><th>Guardar (Reserva)</th><th>Distribuir p/ CPF</th><th>Reserva Necessária</th><th>Lucro Disponível</th><th>Recomendado Distribuir</th></tr></thead>
    <tbody></tbody>
    <tfoot><tr><th>Total</th><th></th><th id="sumGuardar">--</th><th id="sumDistribCPF">--</th><th></th><th></th><th id="sumDistribuir">--</th></tr></tfoot>
  </table>
</section>

<section id="resumo" class="tab">
  <h2>Resumo Anual</h2>
  <table id="tblResumo">
    <thead><tr><th>Mês</th><th>Faturamento</th><th>Impostos</th><th>Fixas</th><th>Líquido</th><th>Saldo Final</th></tr></thead>
    <tbody></tbody>
    <tfoot>
      <tr><th>Total</th>
      <th id="sumBruto">--</th><th id="sumImp">--</th><th id="sumFix">--</th><th id="sumLiq">--</th><th id="sumSaldo">--</th></tr>
    </tfoot>
  </table>
</section>

<section id="instrucoes" class="tab">
  <h2>Instruções</h2>
  <ol class="instructions">
    <li>Na <b>Config</b>, ajuste <b>DAS efetivo</b>, <b>INSS teto</b>, <b>Plano de saúde</b>, <b>Contador</b>, <b>Pró‑labore</b>, <b>Reserva (meses)</b>.</li>
    <li>Use a <b>Matriz de Meses</b> para marcar quando terá <b>Saúde</b>, <b>Contador</b>, <b>INSS Folha</b> e <b>Complementar</b>.</li>
    <li>Em <b>Mensal</b>, informe <b>Faturamento</b> e, se quiser, o <b>Saldo Inicial</b> de cada mês.</li>
    <li>Se ativar <b>Modo Automático</b>, o sistema pode <b>propagar</b> os saldos para o mês seguinte descontando a distribuição recomendada.</li>
    <li>Use <b>Salvar/Carregar</b> (JSON) para backup. Os dados também ficam no <b>localStorage</b> (serverless).</li>
  </ol>
</section>
</main>

<footer>
  <small>MadLab Finance · v2 · Offline · Sem servidor · Tema dark roxo holográfico</small>
</footer>

<script src="app.js"></script>
</body>
</html>
